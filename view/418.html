<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
<meta name="renderer" content="webkit" /> <!-- 让360支持高速渲染模式 -->
<meta http-equiv="pragma" content="no-cache" /> 
<meta http-equiv="Cache-Control" content="no-store, must-revalidate" /> 
<meta http-equiv="expires" content="Wed, 26 Feb 1997 08:21:57 GMT" /> 
<meta http-equiv="expires" content="0" />
<link rel="shortcut icon" href="/favicon.ico?v=1.2" />
<link href="/templets/default/style/common.css?v=1.2" rel="stylesheet" />
<title>C语言中的正负数及其输出</title>
<meta name="keywords" content="语言,中的,正,负数,及其,输出,在,数学,中," />
<meta name="description" content="在数学中，数字有正负之分。在 C语言中也是一样，short、int、long 都可以带上正负号，例如： //负数short a1 = -10;short a2 = -0x2dc9; //十六进制//正数int b1 = +10;int b2 = +0174; //八进制int b3 = 229" />
</head>
<body>
<div id="header" class="clearfix">
	<a id="logo" class="left" href="/">
		<img height="26" src="/templets/default/images/logo_monkey.png" alt="玩转C语言和数据结构Logo" />
	</a>
	<ul id="nav-main" class="hover-none left clearfix">
		<li><a href="/">首页</a></li>
		<li><a href="/ds/">数据结构教程</a></li>
		<li><a href="/c/">C语言教程</a></li>
		<li><a href="/view/212.html">购买教程</a></li>
		<!--<li><a href="/c/">辅导班</a></li>-->
	</ul>
	<span id="sidebar-toggle" class="toggle-btn" toggle-target="#sidebar">目录 <span class="glyphicon"></span></span>
</div>
<!--qq交流群
<div id="header" class="clearfix">
	<ul id="nav-main" class="hover-none left clearfix">
		<li><a style="padding-left:10px" href="/uploads/allimg/240128/2-24012R01153206.jpg" target="_blank">QQ交流群：937184979</a></li>
	</ul>
</div>-->
<div id="main" class="clearfix">
	<div id="sidebar" class="toggle-target">
	<div id="contents">
		<dt><span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span>教程目录</dt>
		
			<dd>
				<span class="channel-num">1</span>
				<a href='/c/base/'>编程基础</a>
			</dd>
		
			<dd>
				<span class="channel-num">2</span>
				<a href='/c/begin/'>C语言初探</a>
			</dd>
		<dd class="this"> <span class="channel-num">3</span> <a href="/c/variable_datatype/">变量和数据类型</a> </dd><dl class="dl-sub"><dd>3.1 <a href="/view/414.html">大话C语言变量和数据类型</a></dd><dd>3.2 <a href="/view/415.html">在屏幕上输出各种类型的数据</a></dd><dd>3.3 <a href="/view/416.html">C语言中的整数（short,int,long）</a></dd><dd>3.4 <a href="/view/417.html">二进制数、八进制数和十六进制数</a></dd><dd>3.5 <a href="/view/418.html">C语言中的正负数及其输出</a></dd><dd>3.6 <a href="/view/419.html">整数在内存中是如何存储的，为什么它堪称天才般的设计</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.7 <a href="/view/420.html">整数的取值范围以及数值溢出</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.8 <a href="/view/421.html">C语言中的小数（float,double）</a></dd><dd>3.9 <a href="/view/422.html">小数在内存中是如何存储的，揭秘诺贝尔奖级别的设计</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.10 <a href="/view/423.html">在C语言中使用英文字符</a></dd><dd>3.11 <a href="/view/425.html">在C语言中使用中文字符</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.12 <a href="/view/426.html">C语言到底使用什么编码？谁说C语言使用ASCII码，真是荒谬！</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.13 <a href="/view/614.html">C99新增加了布尔类型（bool）！</a></dd><dd>3.14 <a href="/view/427.html">C语言转义字符</a></dd><dd>3.15 <a href="/view/428.html">C语言中的几个重要概念</a></dd><dd>3.16 <a href="/view/430.html">C语言加减乘除运算</a></dd><dd>3.17 <a href="/view/431.html">C语言自增(++)和自减(--)</a></dd><dd>3.18 <a href="/view/432.html">变量的定义位置以及初始值</a><span class="glyphicon glyphicon-usd"></span></dd><dd>3.19 <a href="/view/433.html">运算符的优先级和结合性</a></dd><dd>3.20 <a href="/view/435.html">C语言数据类型转换</a></dd></dl>
			<dd>
				<span class="channel-num">4</span>
				<a href='/c/io/'>C语言输入输出</a>
			</dd>
		
			<dd>
				<span class="channel-num">5</span>
				<a href='/c/branch_loop/'>循环结构和选择结构</a>
			</dd>
		
			<dd>
				<span class="channel-num">6</span>
				<a href='/c/array/'>C语言数组</a>
			</dd>
		
			<dd>
				<span class="channel-num">7</span>
				<a href='/c/function/'>C语言函数</a>
			</dd>
		
			<dd>
				<span class="channel-num">8</span>
				<a href='/c/preprocess/'>预处理命令</a>
			</dd>
		
			<dd>
				<span class="channel-num">9</span>
				<a href='/c/pointer/'>指针</a>
			</dd>
		
			<dd>
				<span class="channel-num">10</span>
				<a href='/c/struct/'>结构体</a>
			</dd>
		
			<dd>
				<span class="channel-num">11</span>
				<a href='/c/file/'>文件操作</a>
			</dd>
		
			<dd>
				<span class="channel-num">12</span>
				<a href='/c/debug/'>C语言调试</a>
			</dd>
		
			<dd>
				<span class="channel-num">13</span>
				<a href='/c/module/'>多文件编程</a>
			</dd>
		
			<dd>
				<span class="channel-num">14</span>
				<a href='/c/memory/'>C语言内存精讲</a>
			</dd>
		
			<dd>
				<span class="channel-num">15</span>
				<a href='/c/practice/'>C语言项目实战案例</a>
			</dd>
		
	</div>
</div>
	<div id="article-wrap">
		<div id="article">
			<h1>C语言中的正负数及其输出</h1>
			<div class="pre-next-page pre-next-detail clearfix">
                    <span class="pre left"><span class="glyphicon glyphicon-menu-left"></span> <a href="/view/417.html">二进制数、八进制数和十六进制数</a></span>
                    <span class="next right"><a href="/view/419.html">整数在内存中是如何存储的，为什么它堪称天才般的设计</a> <span class="glyphicon glyphicon-menu-right"></span></span>
                </div>
                <div class="pre-next-page pre-next-brief clearfix">
                    <span class="pre left"><span class="glyphicon glyphicon-menu-left"></span> <a href="#">上一节</a></span>
                    <span class="next right"><a href="#">下一节</a> <span class="glyphicon glyphicon-menu-right"></span></span>
                </div>
                <script type="text/javascript">window.prePageURL = "/view/417.html";window.nextPageURL = "/view/419.html";</script>
			<div id="arc-body">在数学中，数字有正负之分。在 C语言中也是一样，short、int、long 都可以带上正负号，例如：
<pre class="c">
//负数
short a1 = -10;
short a2 = -0x2dc9;  //十六进制
//正数
int b1 = +10;
int b2 = +0174;  //八进制
int b3 = 22910;
//负数和正数相加
long c = (-9) + (+12);</pre>
如果不带正负号，默认就是正数。<br />
<br />
符号也是数字的一部分，也要在内存中体现出来。符号只有正负两种情况，用1位（Bit）就足以表示；<span style="color:#b22222;">C语言规定，把内存的最高位作为符号位</span>。以 int 为例，它占用 32 位的内存，0~30 位表示数值，31 位表示正负号。如下图所示：<br />
<br />
<div style="text-align: center;">
	<img alt="最高位是符号位" src="/uploads/allimg/240820/161K02I6-0.png" /></div>
<blockquote>
	在编程语言中，计数往往是从0开始，例如字符串 &quot;abc123&quot;，我们称第 0 个字符是 a，第 1 个字符是 b，第 5 个字符是 3。这和我们平时从 1 开始计数的习惯不一样，大家要慢慢适应，培养编程思维。</blockquote>
<span style="color:#b22222;">C语言规定，在符号位中，用 0 表示正数，用 1 表示负数。</span>例如 int 类型的 -10 和 +16 在内存中的表示如下：<br />
<br />
<div style="text-align: center;">
	<img alt="负数-10和正数+16在内存中的存储" src="/uploads/allimg/240820/161K0C25-1.jpg" /></div>
<br />
short、int 和 long 类型默认都是带符号位的，符号位以外的内存才是数值位。如果只考虑正数，那么各种类型能表示的数值范围（取值范围）就比原来小了一半。<br />
<br />
但是在很多情况下，我们非常确定某个数字只能是正数，比如班级学生的人数、字符串的长度、内存地址等，这个时候符号位就是多余的了，就不如删掉符号位，把所有的位都用来存储数值，这样能表示的数值范围更大（大一倍）。<br />
<br />
C语言允许我们这样做，如果不希望设置符号位，可以在数据类型前面加上 <span style="color:#008000;"><strong>unsigned</strong></span> 关键字，例如：
<pre class="c">
unsigned short a = 12;
unsigned int b = 1002;
unsigned long c = 9892320;</pre>
这样，short、int、long 中就没有符号位了，所有的位都用来表示数值，正数的取值范围更大了。这也意味着，使用了 unsigned 后只能表示正数，不能再表示负数了。<br />
<br />
如果将一个数字分为符号和数值两部分，那么不加 unsigned 的数字称为<span style="color:#008000;">有符号数</span>，能表示正数和负数，加了 unsigned 的数字称为<span style="color:#008000;">无符号数</span>，只能表示正数。<br />
<br />
请读者注意一个小细节，如果是<code>unsigned int</code>类型，那么可以省略 int ，只写 unsigned，例如：
<pre class="info-box">
unsigned n = 100;</pre>
它等价于：
<pre class="info-box">
unsigned int n = 100;</pre>
<h2>
	无符号数的输出</h2>
无符号数可以以八进制、十进制和十六进制的形式输出，它们对应的格式控制符分别为：<br />
<br />
<table>
	<tbody>
		<tr>
			<th>
				&nbsp;</th>
			<th>
				unsigned short</th>
			<th>
				unsigned int</th>
			<th>
				unsigned long</th>
		</tr>
		<tr>
			<th>
				八进制</th>
			<td>
				%ho</td>
			<td>
				%o</td>
			<td>
				%lo</td>
		</tr>
		<tr>
			<th>
				十进制</th>
			<td>
				%hu</td>
			<td>
				%u</td>
			<td>
				%lu</td>
		</tr>
		<tr>
			<th>
				十六进制</th>
			<td>
				%hx 或者 %hX</td>
			<td>
				%x 或者 %X</td>
			<td>
				%lx 或者 %lX</td>
		</tr>
	</tbody>
</table>
<br />
上节我们也讲到了不同进制形式的输出，但是上节我们还没有讲到正负数，所以也没有关心这一点，只是&ldquo;笼统&rdquo;地介绍了一遍。现在本节已经讲到了正负数，那我们就再深入地说一下。<br />
<br />
严格来说，格式控制符和整数的符号是紧密相关的，具体就是：
<ul>
	<li>
		%d 以十进制形式输出有符号数；</li>
	<li>
		%u 以十进制形式输出无符号数；</li>
	<li>
		%o 以八进制形式输出无符号数；</li>
	<li>
		%x 以十六进制形式输出无符号数。</li>
</ul>
<br />
那么，如何以八进制和十六进制形式输出有符号数呢？很遗憾，printf 并不支持，也没有对应的格式控制符。在实际开发中，也基本没有&ldquo;输出负的八进制数或者十六进制数&rdquo;这样的需求，我想可能正是因为这一点，printf 才没有提供对应的格式控制符。<br />
<br />
下表全面地总结了不同类型的整数，以不同进制的形式输出时对应的格式控制符（<code>--</code>表示没有对应的格式控制符）。<br />
<br />
<table>
	<tbody>
		<tr>
			<th>
				&nbsp;</th>
			<th>
				short</th>
			<th>
				int</th>
			<th>
				long</th>
			<th>
				unsigned short</th>
			<th>
				unsigned int</th>
			<th>
				unsigned long</th>
		</tr>
		<tr>
			<th>
				八进制</th>
			<td>
				--</td>
			<td>
				--</td>
			<td>
				--</td>
			<td>
				%ho</td>
			<td>
				%o</td>
			<td>
				%lo</td>
		</tr>
		<tr>
			<th>
				十进制</th>
			<td>
				%hd</td>
			<td>
				%d</td>
			<td>
				%ld</td>
			<td>
				%hu</td>
			<td>
				%u</td>
			<td>
				%lu</td>
		</tr>
		<tr>
			<th>
				十六进制</th>
			<td>
				--</td>
			<td>
				--</td>
			<td>
				--</td>
			<td>
				%hx 或者 %hX</td>
			<td>
				%x 或者 %X</td>
			<td>
				%lx 或者 %lX</td>
		</tr>
	</tbody>
</table>
<br />
有读者可能会问，上节我们也使用 %o 和 %x 来输出有符号数了，为什么没有发生错误呢？这是因为：
<ul>
	<li>
		当以有符号数的形式输出时，printf 会读取数字所占用的内存，并把最高位作为符号位，把剩下的内存作为数值位；</li>
	<li>
		当以无符号数的形式输出时，printf 也会读取数字所占用的内存，并把所有的内存都作为数值位对待。</li>
</ul>
<br />
对于一个有符号的正数，它的符号位是 0，当按照无符号数的形式读取时，符号位就变成了数值位，但是该位恰好是 0 而不是 1，所以对数值不会产生影响，这就好比在一个数字前面加 0，有多少个 0 都不会影响数字的值。<br />
<br />
如果对一个有符号的负数使用 %o 或者 %x 输出，那么结果就会大相径庭，读者可以亲试。<br />
<br />
<span style="color:#b22222;">可以说，&ldquo;有符号正数的最高位是 0&rdquo;这个巧合才使得 %o 和 %x 输出有符号数时不会出错。</span><br />
<br />
再次强调，不管是以 %o、%u、%x 输出有符号数，还是以 %d 输出无符号数，编译器都不会报错，只是对内存的解释不同了。%o、%d、%u、%x 这些格式控制符不会关心数字在定义时到底是有符号的还是无符号的：
<ul>
	<li>
		你让我输出无符号数，那我在读取内存时就不区分符号位和数值位了，我会把所有的内存都看做数值位；</li>
	<li>
		你让我输出有符号数，那我在读取内存时会把最高位作为符号位，把剩下的内存作为数值位。</li>
</ul>
<br />
说得再直接一些，我管你在定义时是有符号数还是无符号数呢，我只关心内存，有符号数也可以按照无符号数输出，无符号数也可以按照有符号数输出，至于输出结果对不对，那我就不管了，你自己承担风险。<br />
<br />
下面的代码进行了全面的演示：
<pre class="cpp">
#include &lt;stdio.h&gt;
int main()
{
    short a = 0100;  //八进制
    int b = -0x1;  //十六进制
    long c = 720;  //十进制
   
    unsigned short m = 0xffff;  //十六进制
    unsigned int n = 0x80000000;  //十六进制
    unsigned long p = 100;  //十进制
   
    //以无符号的形式输出有符号数
    printf(&quot;a=%#ho, b=%#x, c=%ld\n&quot;, a, b, c);
    //以有符号数的形式输出无符号类型（只能以十进制形式输出）
    printf(&quot;m=%hd, n=%d, p=%ld\n&quot;, m, n, p);

    return 0;
}</pre>
运行结果：<br />
a=0100, b=0xffffffff, c=720<br />
m=-1, n=-2147483648, p=100<br />
<br />
对于绝大多数初学者来说，b、m、n 的输出结果看起来非常奇怪，甚至不能理解。按照一般的推理，b、m、n 这三个整数在内存中的存储形式分别是：<br />
<br />
<div style="text-align: center;">
	<img alt="b、m、n三个整数在内存中的存储形式" src="/uploads/allimg/240820/161K01205-2.jpg" style="height: 141px;" /></div>
<br />
当以 %x 输出 b 时，结果应该是 0x80000001；当以 %hd、%d 输出 m、n 时，结果应该分别是 -7fff、-0。但是实际的输出结果和我们推理的结果却大相径庭，这是为什么呢？
<blockquote>
	注意，-7fff 是十六进制形式。%d 本来应该输出十进制，这里只是为了看起来方便，才改为十六进制。</blockquote>
其实这跟整数在内存中的存储形式以及读取方式有关。b 是一个有符号的负数，它在内存中并不是像上图演示的那样存储，而是要经过一定的转换才能写入内存；m、n 的内存虽然没有错误，但是当以 %d 输出时，并不是原样输出，而是有一个逆向的转换过程（和存储时的转换过程恰好相反）。<br />
<br />
也就是说，整数在写入内存之前可能会发生转换，在读取时也可能会发生转换，而我们没有考虑这种转换，所以才会导致推理错误。那么，整数在写入内存前，以及在读取时究竟发生了怎样的转换呢？为什么会发生这种转换呢？我们将在《<a href="/view/419.html" target="_blank">整数在内存中是如何存储的，为什么它堪称天才般的设计</a>》一节中揭开谜底。<br />
</div>
			<div class="pre-next-page pre-next-detail clearfix">
                    <span class="pre left"><span class="glyphicon glyphicon-menu-left"></span> <a href="/view/417.html">二进制数、八进制数和十六进制数</a></span>
                    <span class="next right"><a href="/view/419.html">整数在内存中是如何存储的，为什么它堪称天才般的设计</a> <span class="glyphicon glyphicon-menu-right"></span></span>
                </div>
                <div class="pre-next-page pre-next-brief clearfix">
                    <span class="pre left"><span class="glyphicon glyphicon-menu-left"></span> <a href="#">上一节</a></span>
                    <span class="next right"><a href="#">下一节</a> <span class="glyphicon glyphicon-menu-right"></span></span>
                </div>
                <script type="text/javascript">window.prePageURL = "/view/417.html";window.nextPageURL = "/view/419.html";</script>
		</div>
		
	</div>
</div>
<div id="addweixin-widget" class="clearfix">
	<div class="box">
		<p>
			<a href="/uploads/allimg/240115/2-240115210631414.png" target="_blank"><img src="/uploads/allimg/240115/2-240115210631414.png" alt="添加微信咨询" title="点击查看大图"></a>
			<span class="pc-tip">添加管理员微信<br/>免费领视频教程</span>
			<span class="wap-tip">加管理员微信免费领视频教程<br>微信ID：xiexuewu333</span>
		</p>
		<span id="close-addweixin-widget" class="glyphicon glyphicon-remove-circle"></span>
	</div>
</div>
<script type="text/javascript">
// 当前文章ID
window.arcIdRaw = 'a_' + 418;
window.arcId = "a66atbawQhGggfDfAw0tJYReZZQMcZN3tZc6SoDYDY7G5ijyUnZtqUZJKw";
window.siteId = 1;
window.cmsTempletsVer = "1.2";
</script>
<div id="footer">
	<ul id="nav-bottom" class="clearfix">
		<li><a href="/sitemap/" target="_blank">最近更新</a></li>
		<li><a href="/view/212.html" target="_blank">购买教程（带答疑）</a></li>
		<li><a href="/view/about_website.html" target="_blank">关于网站</a></li>
		<li><a href="/view/267.html" target="_blank">联系站长</a></li>
	</ul>
</div>

<script src="/templets/default/script/jquery1.12.4.min.js"></script>
<script src="/templets/default/script/jquery.snippet.js"></script>
<script src="/templets/default/script/common.js?v=1.2"></script>

<span style="display:none;"><script src="https://s22.cnzz.com/z_stat.php?id=1273514649&web_id=1273514649" language="JavaScript"></script></span>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b2de4372415b89b41cef56560ba39728";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>